<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8" />
  <title>Auto Passport Mock</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <style>
    :root{
      --bg:#0f172a; --panel:#111827; --soft:#1f2937; --text:#e5e7eb;
      --muted:#9ca3af; --primary:#22c55e; --danger:#ef4444; --warn:#f59e0b;
      --accent:#38bdf8; --border:#374151;
    }
    *{box-sizing:border-box}
    body{
      margin:0; background:var(--bg); color:var(--text); font-family:system-ui,-apple-system,Segoe UI,Roboto,Arial,sans-serif;
    }
    header{
      padding:24px; border-bottom:1px solid var(--border); background:linear-gradient(90deg,#0ea5e9 0,#22c55e 100%);
      color:#0b1221;
    }
    header .wrap{max-width:1100px; margin:0 auto; display:flex; align-items:center; justify-content:space-between}
    .brand{display:flex; align-items:center; gap:12px}
    .brand .logo{
      width:38px; height:38px; border-radius:10px; background:#0b1221; color:#22c55e;
      display:grid; place-items:center; font-weight:700; box-shadow:0 6px 20px rgba(0,0,0,.25);
    }
    .brand .title{font-size:20px; font-weight:700}
    .brand .subtitle{font-size:13px; color:#0b1221; opacity:.8}
    nav a{color:#0b1221; text-decoration:none; margin-left:16px; font-weight:600}
    main{max-width:1100px; margin:22px auto; padding:0 22px}
    .grid{display:grid; grid-template-columns:1fr; gap:22px}
    @media(min-width:980px){ .grid{grid-template-columns:1fr 1fr} }

    .card{
      background:var(--panel); border:1px solid var(--border); border-radius:14px; overflow:hidden;
      box-shadow:0 10px 30px rgba(0,0,0,.25);
    }
    .card header{background:var(--soft); border-bottom:1px solid var(--border); color:var(--text)}
    .card header .wrap{padding:14px 18px; display:flex; align-items:center; justify-content:space-between}
    .card h2{margin:0; font-size:18px}
    .tools{display:flex; gap:10px; flex-wrap:wrap}
    .tools .btn{padding:8px 12px; border:1px solid var(--border); border-radius:10px; background:#0f172a; color:var(--text); cursor:pointer}
    .tools .btn.primary{background:var(--primary); border-color:transparent; color:#0b1221; font-weight:700}
    .tools .btn.soft{background:var(--soft)}
    .tools .btn.warn{background:var(--warn); color:#0b1221; font-weight:700}
    .tools .btn.danger{background:var(--danger); color:#fff; font-weight:700}

    .section{padding:16px 18px; border-top:1px solid var(--border)}
    .row{display:flex; gap:12px; flex-wrap:wrap}
    .field{flex:1; min-width:220px}
    .field label{display:block; font-size:13px; color:var(--muted); margin-bottom:6px}
    .field input,.field select,.field textarea{
      width:100%; padding:9px 10px; border:1px solid var(--border); border-radius:10px;
      background:#0f172a; color:var(--text)
    }
    .field textarea{min-height:80px; resize:vertical}

    table{width:100%; border-collapse:collapse; margin-top:12px}
    th,td{padding:10px; border-bottom:1px solid var(--border); text-align:left; font-size:14px}
    th{color:var(--muted); font-weight:600}
    tbody tr:hover{background:#0f1b33}
    .tag{display:inline-block; padding:4px 8px; border-radius:999px; font-size:12px}
    .tag.green{background:#052; color:#bfffc2}
    .tag.yellow{background:#332600; color:#ffe9a3}
    .tag.red{background:#300; color:#ffb0b0}
    .actions{display:flex; gap:8px}
    .actions .btn{padding:6px 10px; font-size:12px}

    .footer{margin-top:24px; color:var(--muted); font-size:12px; text-align:center}
    .hidden{display:none !important}
    .stat{display:flex; gap:12px; flex-wrap:wrap; margin-top:8px}
    .stat .pill{background:#0f172a; border:1px solid var(--border); border-radius:999px; padding:6px 10px; font-size:12px}
    .kbd{font-family:ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace; background:#0f172a; border:1px solid var(--border); border-radius:6px; padding:2px 6px}
  </style>
</head>
<body>
  <header>
    <div class="wrap">
      <div class="brand">
        <div class="logo">AM</div>
        <div>
          <div class="title">Auto Passport</div>
          <div class="subtitle">Макет сервиса учёта водителей и автотранспорта</div>
        </div>
      </div>
      <nav>
        <a href="#drivers">Водители</a>
        <a href="#vehicles">Автотранспорт</a>
      </nav>
    </div>
  </header>

  <main>
    <div class="grid">
      <!-- Паспорт водителя -->
      <section id="drivers" class="card">
        <header>
          <div class="wrap">
            <h2>Паспорт водителя</h2>
            <div class="tools">
              <button class="btn primary" id="addDriverBtn">+ Добавить</button>
              <button class="btn soft" id="exportDriversBtn">Экспорт JSON</button>
              <button class="btn warn" id="saveDriversBtn">Сохранить</button>
              <button class="btn danger" id="resetDriversBtn">Сбросить</button>
            </div>
          </div>
        </header>

        <div class="section">
          <div class="row">
            <div class="field">
              <label>Поиск по ФИО или № прав</label>
              <input type="text" id="driverSearch" placeholder="Напр.: Иванов или 1234-567890" />
            </div>
            <div class="field">
              <label>Категории</label>
              <select id="driverCategoryFilter">
                <option value="">Все</option>
                <option>A</option>
                <option>B</option>
                <option>C</option>
                <option>D</option>
                <option>E</option>
              </select>
            </div>
            <div class="field">
              <label>Статус медсправки</label>
              <select id="medFilter">
                <option value="">Все</option>
                <option value="valid">Действительна</option>
                <option value="expired">Просрочена</option>
              </select>
            </div>
          </div>

          <div class="stat" id="driverStats"></div>

          <table id="driverTable">
            <thead>
              <tr>
                <th>#</th>
                <th>ФИО</th>
                <th>№ прав</th>
                <th>Категории</th>
                <th>Медсправка</th>
                <th>Примечания</th>
                <th>Действия</th>
              </tr>
            </thead>
            <tbody></tbody>
          </table>
        </div>

        <!-- Форма добавления/редактирования -->
        <div class="section hidden" id="driverFormWrap">
          <div class="row">
            <div class="field"><label>ФИО</label><input id="dName" /></div>
            <div class="field"><label>№ прав</label><input id="dLicense" placeholder="XXXX-XXXXXX" /></div>
            <div class="field"><label>Категории (через запятую)</label><input id="dCats" placeholder="B, C" /></div>
          </div>
          <div class="row">
            <div class="field">
              <label>Медсправка до</label>
              <input type="date" id="dMedDate" />
            </div>
            <div class="field">
              <label>Примечания</label>
              <textarea id="dNotes" placeholder="Напр.: прохождение техосмотра, штрафы..."></textarea>
            </div>
            <div class="field">
              <label>&nbsp;</label>
              <button class="btn primary" id="saveDriverFormBtn">Сохранить запись</button>
            </div>
          </div>
        </div>
      </section>

      <!-- Паспорт автотранспорта -->
      <section id="vehicles" class="card">
        <header>
          <div class="wrap">
            <h2>Паспорт автотранспорта</h2>
            <div class="tools">
              <button class="btn primary" id="addVehicleBtn">+ Добавить</button>
              <button class="btn soft" id="exportVehiclesBtn">Экспорт JSON</button>
              <button class="btn warn" id="saveVehiclesBtn">Сохранить</button>
              <button class="btn danger" id="resetVehiclesBtn">Сбросить</button>
            </div>
          </div>
        </header>

        <div class="section">
          <div class="row">
            <div class="field">
              <label>Поиск по гос№, VIN или марке</label>
              <input type="text" id="vehicleSearch" placeholder="Напр.: KZ123ABC, VF3XXXXXXXXX, Toyota" />
            </div>
            <div class="field">
              <label>Страхование</label>
              <select id="insFilter">
                <option value="">Все</option>
                <option value="valid">Застрахован</option>
                <option value="expired">Просрочено</option>
              </select>
            </div>
            <div class="field">
              <label>ТО срок</label>
              <select id="serviceFilter">
                <option value="">Все</option>
                <option value="ok">В норме</option>
                <option value="soon">Скоро</option>
                <option value="overdue">Просрочено</option>
              </select>
            </div>
          </div>

          <div class="stat" id="vehicleStats"></div>

          <table id="vehicleTable">
            <thead>
              <tr>
                <th>#</th>
                <th>Гос№</th>
                <th>Марка/Модель</th>
                <th>VIN</th>
                <th>Страхование</th>
                <th>ТО</th>
                <th>Владелец</th>
                <th>Действия</th>
              </tr>
            </thead>
            <tbody></tbody>
          </table>
        </div>

        <!-- Форма добавления/редактирования -->
        <div class="section hidden" id="vehicleFormWrap">
          <div class="row">
            <div class="field"><label>Гос№</label><input id="vPlate" placeholder="KZ123ABC" /></div>
            <div class="field"><label>Марка/Модель</label><input id="vMake" placeholder="Toyota Camry" /></div>
            <div class="field"><label>VIN</label><input id="vVin" placeholder="VF3XXXXXXXXXXXXX" /></div>
          </div>
          <div class="row">
            <div class="field"><label>Страховка до</label><input type="date" id="vInsDate" /></div>
            <div class="field"><label>ТО до</label><input type="date" id="vServiceDate" /></div>
            <div class="field"><label>Владелец (ФИО)</label><input id="vOwner" placeholder="Иванов И.И." /></div>
          </div>
          <div class="row">
            <div class="field">
              <label>Примечания</label>
              <textarea id="vNotes" placeholder="Напр.: замена масла, страховщик, класс..." ></textarea>
            </div>
            <div class="field">
              <label>&nbsp;</label>
              <button class="btn primary" id="saveVehicleFormBtn">Сохранить запись</button>
            </div>
          </div>
        </div>
      </section>
    </div>

    <div class="footer">
      Горячие клавиши: <span class="kbd">/</span> — фокус поиска, <span class="kbd">N</span> — новая запись, <span class="kbd">S</span> — сохранить.
    </div>
  </main>

  <script>
    // ----- УТИЛИТЫ -----
    const qs = s => document.querySelector(s);
    const qsa = s => [...document.querySelectorAll(s)];
    const formatDate = d => d ? new Date(d).toLocaleDateString('ru-RU') : '—';
    const daysLeft = d => {
      if(!d) return null;
      const diff = (new Date(d) - new Date()) / (1000*60*60*24);
      return Math.floor(diff);
    };
    const statusTag = (days) => {
      if(days === null) return '<span class="tag yellow">нет данных</span>';
      if(days >= 14) return `<span class="tag green">в норме (${days} дн.)</span>`;
      if(days >= 0) return `<span class="tag yellow">скоро (${days} дн.)</span>`;
      return `<span class="tag red">просрочено (${days} дн.)</span>`;
    };
    const insTag = d => {
      const x = daysLeft(d);
      if(x === null) return '<span class="tag yellow">нет данных</span>';
      return x >= 0 ? `<span class="tag green">застрахован до ${formatDate(d)}</span>`
                    : `<span class="tag red">просрочено ${formatDate(d)}</span>`;
    };
    const medTag = d => {
      const x = daysLeft(d);
      if(x === null) return '<span class="tag yellow">нет данных</span>';
      return x >= 0 ? `<span class="tag green">действительна до ${formatDate(d)}</span>`
                    : `<span class="tag red">просрочена ${formatDate(d)}</span>`;
    };

    // ----- ДАННЫЕ (моки + localStorage) -----
    const LS_KEYS = { drivers:'am_drivers', vehicles:'am_vehicles' };
    const mockDrivers = [
      { id: crypto.randomUUID(), name:'Иванов Иван', license:'1234-567890', cats:['B','C'], medDate:addDays(60), notes:'Допуск к грузовым' },
      { id: crypto.randomUUID(), name:'Петров Пётр', license:'4321-098765', cats:['B'], medDate:addDays(5), notes:'Скоро медкомиссия' },
      { id: crypto.randomUUID(), name:'Сергеев Сергей', license:'5555-111111', cats:['A','B','D'], medDate:addDays(-12), notes:'Просрочена медсправка' },
    ];
    const mockVehicles = [
      { id: crypto.randomUUID(), plate:'KZ123ABC', make:'Toyota Camry', vin:'JT3BG22K3V0123456', insDate:addDays(120), serviceDate:addDays(25), owner:'Иванов Иван', notes:'КАСКО, ТО-3' },
      { id: crypto.randomUUID(), plate:'KZ777ZZZ', make:'Hyundai Tucson', vin:'KMHJB81BBPU765432', insDate:addDays(-10), serviceDate:addDays(3), owner:'ООО «Автологистик»', notes:'ОСАГО' },
      { id: crypto.randomUUID(), plate:'KZ555KAZ', make:'ГАЗель Next', vin:'XTH1234567890KAZ', insDate:addDays(30), serviceDate:addDays(-2), owner:'Петров Пётр', notes:'ТО просрочено' },
    ];
    function addDays(n){ const d=new Date(); d.setDate(d.getDate()+n); return d.toISOString().slice(0,10); }

    let drivers = load(LS_KEYS.drivers) || mockDrivers;
    let vehicles = load(LS_KEYS.vehicles) || mockVehicles;
    let editingDriverId = null;
    let editingVehicleId = null;

    function load(key){
      try{ const raw = localStorage.getItem(key); return raw ? JSON.parse(raw) : null; }catch(e){ return null; }
    }
    function saveAll(){
      localStorage.setItem(LS_KEYS.drivers, JSON.stringify(drivers));
      localStorage.setItem(LS_KEYS.vehicles, JSON.stringify(vehicles));
      toast('Данные сохранены локально');
    }
    function resetAll(){
      localStorage.removeItem(LS_KEYS.drivers);
      localStorage.removeItem(LS_KEYS.vehicles);
      drivers = [...mockDrivers];
      vehicles = [...mockVehicles];
      renderDrivers();
      renderVehicles();
      toast('Сброс к макетным данным');
    }

    // ----- РЕНДЕР ВОДИТЕЛЕЙ -----
    function renderDrivers(){
      const search = qs('#driverSearch').value.trim().toLowerCase();
      const cat = qs('#driverCategoryFilter').value;
      const med = qs('#medFilter').value;

      const filtered = drivers.filter(d=>{
        const q = `${d.name} ${d.license}`.toLowerCase().includes(search);
        const byCat = cat ? d.cats.includes(cat) : true;
        const byMed = med ? (med==='valid' ? daysLeft(d.medDate)>=0 : daysLeft(d.medDate)<0) : true;
        return q && byCat && byMed;
      });

      // Статистика
      const total = drivers.length;
      const expMed = drivers.filter(d=>daysLeft(d.medDate)<0).length;
      const soonMed = drivers.filter(d=>daysLeft(d.medDate)>=0 && daysLeft(d.medDate)<14).length;
      qs('#driverStats').innerHTML = `
        <div class="pill">Всего: ${total}</div>
        <div class="pill">Медсправка скоро: ${soonMed}</div>
        <div class="pill">Медсправка просрочена: ${expMed}</div>
        <div class="pill">Отфильтровано: ${filtered.length}</div>
      `;

      const tbody = qs('#driverTable tbody');
      tbody.innerHTML = filtered.map((d,i)=>`
        <tr>
          <td>${i+1}</td>
          <td>${d.name}</td>
          <td><span class="kbd">${d.license}</span></td>
          <td>${d.cats.join(', ')}</td>
          <td>${medTag(d.medDate)}</td>
          <td>${d.notes||'—'}</td>
          <td class="actions">
            <button class="btn soft" onclick="editDriver('${d.id}')">Редакт.</button>
            <button class="btn danger" onclick="deleteDriver('${d.id}')">Удалить</button>
          </td>
        </tr>
      `).join('');
    }
    function editDriver(id){
      const d = drivers.find(x=>x.id===id); if(!d) return;
      editingDriverId = id;
      qs('#driverFormWrap').classList.remove('hidden');
      qs('#dName').value = d.name;
      qs('#dLicense').value = d.license;
      qs('#dCats').value = d.cats.join(', ');
      qs('#dMedDate').value = d.medDate || '';
      qs('#dNotes').value = d.notes || '';
      toast('Редактирование записи водителя');
    }
    function deleteDriver(id){
      if(!confirm('Удалить запись?')) return;
      drivers = drivers.filter(d=>d.id!==id);
      renderDrivers();
      toast('Запись удалена');
    }
    function addDriver(){
      editingDriverId = null;
      qs('#driverFormWrap').classList.remove('hidden');
      ['#dName','#dLicense','#dCats','#dMedDate','#dNotes'].forEach(s=>qs(s).value='');
      qs('#dName').focus();
    }
    function saveDriver(){
      const name = qs('#dName').value.trim();
      const license = qs('#dLicense').value.trim();
      const cats = qs('#dCats').value.split(',').map(x=>x.trim()).filter(Boolean);
      const medDate = qs('#dMedDate').value || null;
      const notes = qs('#dNotes').value.trim();

      if(!name || !license){ return toast('ФИО и № прав обязательны', true); }

      if(editingDriverId){
        const idx = drivers.findIndex(d=>d.id===editingDriverId);
        if(idx>=0) drivers[idx] = { ...drivers[idx], name, license, cats, medDate, notes };
        toast('Запись обновлена');
      }else{
        drivers.unshift({ id: crypto.randomUUID(), name, license, cats, medDate, notes });
        toast('Запись добавлена');
      }
      qs('#driverFormWrap').classList.add('hidden');
      renderDrivers();
    }
    function exportDrivers(){
      downloadJSON('drivers.json', drivers);
    }

    // ----- РЕНДЕР ТРАНСПОРТА -----
    function renderVehicles(){
      const search = qs('#vehicleSearch').value.trim().toLowerCase();
      const ins = qs('#insFilter').value;
      const svc = qs('#serviceFilter').value;

      const filtered = vehicles.filter(v=>{
        const q = `${v.plate} ${v.vin} ${v.make}`.toLowerCase().includes(search);
        const byIns = ins ? (ins==='valid' ? daysLeft(v.insDate)>=0 : daysLeft(v.insDate)<0) : true;
        const dSvc = daysLeft(v.serviceDate);
        const bySvc = svc ? (
          svc==='ok' ? dSvc!==null && dSvc>=14 :
          svc==='soon' ? dSvc!==null && dSvc>=0 && dSvc<14 :
          dSvc!==null && dSvc<0
        ) : true;
        return q && byIns && bySvc;
      });

      const total = vehicles.length;
      const expIns = vehicles.filter(v=>daysLeft(v.insDate)<0).length;
      const soonSvc = vehicles.filter(v=>daysLeft(v.serviceDate)>=0 && daysLeft(v.serviceDate)<14).length;
      const expSvc = vehicles.filter(v=>daysLeft(v.serviceDate)<0).length;
      qs('#vehicleStats').innerHTML = `
        <div class="pill">Всего: ${total}</div>
        <div class="pill">Страховка просрочена: ${expIns}</div>
        <div class="pill">ТО скоро: ${soonSvc}</div>
        <div class="pill">ТО просрочено: ${expSvc}</div>
        <div class="pill">Отфильтровано: ${filtered.length}</div>
      `;

      const tbody = qs('#vehicleTable tbody');
      tbody.innerHTML = filtered.map((v,i)=>`
        <tr>
          <td>${i+1}</td>
          <td><span class="kbd">${v.plate}</span></td>
          <td>${v.make}</td>
          <td><span class="kbd">${v.vin}</span></td>
          <td>${insTag(v.insDate)}</td>
          <td>${statusTag(daysLeft(v.serviceDate))}</td>
          <td>${v.owner||'—'}</td>
          <td class="actions">
            <button class="btn soft" onclick="editVehicle('${v.id}')">Редакт.</button>
            <button class="btn danger" onclick="deleteVehicle('${v.id}')">Удалить</button>
          </td>
        </tr>
      `).join('');
    }
    function editVehicle(id){
      const v = vehicles.find(x=>x.id===id); if(!v) return;
      editingVehicleId = id;
      qs('#vehicleFormWrap').classList.remove('hidden');
      qs('#vPlate').value = v.plate;
      qs('#vMake').value = v.make;
      qs('#vVin').value = v.vin;
      qs('#vInsDate').value = v.insDate || '';
      qs('#vServiceDate').value = v.serviceDate || '';
      qs('#vOwner').value = v.owner || '';
      qs('#vNotes').value = v.notes || '';
      toast('Редактирование записи транспорта');
    }
    function deleteVehicle(id){
      if(!confirm('Удалить запись?')) return;
      vehicles = vehicles.filter(v=>v.id!==id);
      renderVehicles();
      toast('Запись удалена');
    }
    function addVehicle(){
      editingVehicleId = null;
      qs('#vehicleFormWrap').classList.remove('hidden');
      ['#vPlate','#vMake','#vVin','#vInsDate','#vServiceDate','#vOwner','#vNotes'].forEach(s=>qs(s).value='');
      qs('#vPlate').focus();
    }
    function saveVehicle(){
      const plate = qs('#vPlate').value.trim();
      const make = qs('#vMake').value.trim();
      const vin = qs('#vVin').value.trim();
      const insDate = qs('#vInsDate').value || null;
      const serviceDate = qs('#vServiceDate').value || null;
      const owner = qs('#vOwner').value.trim();
      const notes = qs('#vNotes').value.trim();

      if(!plate || !make){ return toast('Гос№ и Марка/Модель обязательны', true); }

      if(editingVehicleId){
        const idx = vehicles.findIndex(v=>v.id===editingVehicleId);
        if(idx>=0) vehicles[idx] = { ...vehicles[idx], plate, make, vin, insDate, serviceDate, owner, notes };
        toast('Запись обновлена');
      }else{
        vehicles.unshift({ id: crypto.randomUUID(), plate, make, vin, insDate, serviceDate, owner, notes });
        toast('Запись добавлена');
      }
      qs('#vehicleFormWrap').classList.add('hidden');
      renderVehicles();
    }
    function exportVehicles(){
      downloadJSON('vehicles.json', vehicles);
    }

    // ----- ХЕЛПЕРЫ: скачивание и уведомления -----
    function downloadJSON(filename, data){
      const blob = new Blob([JSON.stringify(data,null,2)], {type:'application/json'});
      const a = document.createElement('a');
      a.href = URL.createObjectURL(blob); a.download = filename; a.click();
      setTimeout(()=>URL.revokeObjectURL(a.href), 1000);
    }
    function toast(msg, error=false){
      const el = document.createElement('div');
      el.textContent = msg;
      el.style.position='fixed';
      el.style.bottom='16px';
      el.style.right='16px';
      el.style.padding='10px 12px';
      el.style.border='1px solid var(--border)';
      el.style.borderRadius='10px';
      el.style.background= error ? 'rgba(239,68,68,.15)' : 'rgba(34,197,94,.15)';
      el.style.color= error ? '#fecaca' : '#bbf7d0';
      el.style.backdropFilter='blur(6px)';
      el.style.zIndex='9999';
      document.body.appendChild(el);
      setTimeout(()=>el.remove(), 2200);
    }

    // ----- СОБЫТИЯ -----
    // Водители
    qs('#addDriverBtn').addEventListener('click', addDriver);
    qs('#saveDriverFormBtn').addEventListener('click', saveDriver);
    qs('#exportDriversBtn').addEventListener('click', exportDrivers);
    qs('#saveDriversBtn').addEventListener('click', saveAll);
    qs('#resetDriversBtn').addEventListener('click', resetAll);
    ['#driverSearch','#driverCategoryFilter','#medFilter'].forEach(s=>{
      qs(s).addEventListener('input', renderDrivers);
      qs(s).addEventListener('change', renderDrivers);
    });

    // Транспорт
    qs('#addVehicleBtn').addEventListener('click', addVehicle);
    qs('#saveVehicleFormBtn').addEventListener('click', saveVehicle);
    qs('#exportVehiclesBtn').addEventListener('click', exportVehicles);
    qs('#saveVehiclesBtn').addEventListener('click', saveAll);
    qs('#resetVehiclesBtn').addEventListener('click', resetAll);
    ['#vehicleSearch','#insFilter','#serviceFilter'].forEach(s=>{
      qs(s).addEventListener('input', renderVehicles);
      qs(s).addEventListener('change', renderVehicles);
    });

    // Горячие клавиши
    document.addEventListener('keydown', (e)=>{
      if(e.key==='/'){ e.preventDefault(); qs('#driverSearch').focus(); }
      if(e.key.toLowerCase()==='n'){ // новая запись
        if(document.activeElement.tagName==='INPUT' || document.activeElement.tagName==='TEXTAREA') return;
        addDriver(); addVehicle(); // подсказываем обе формы, пользователь выберет
      }
      if(e.key.toLowerCase()==='s'){ // сохранить
        if(document.activeElement.tagName==='INPUT' || document.activeElement.tagName==='TEXTAREA') return;
        saveAll();
      }
    });

    // Первый рендер
    renderDrivers();
    renderVehicles();
  </script>
</body>
</html>